<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:sf="http://www.springframework.org/tags/form">
<!-- Spring Form -->
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet"
		  href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css">
	<style>
        .no-wrap {
            white-space: nowrap;
        }
    	.element-margin { /* 選項之間有間格 */
			margin-right:2px;
			margin-left:5px;
		}
	</style>
	<title>User Form</title>
</head>

<body style="padding: 15px"> <!-- 留白之美 -->
	<!-- 左(User Form)-右(User List) -->
	<table>
		<tr>
			<td valign="top" style="padding: 6px">
				<!-- User Form -->
				<sf:form class="pure-form" method="post" 
	         			 th:action="${index != null} ? @{/user/{id}(id=${index})} : @{/user/}"
	         			 th:object="${user}"> <!-- modelAttribute -->
					<fieldset> 
						<legend>User Form</legend>
						<!-- user 表單元素 --> 
			            <div>
			                <label>姓名:</label>
			                <sf:input path="name" /> <!-- path指的是 User的屬性。要相同 才可data binding -->
			            </div>
			            <div>
			                <label>年齡:</label>
			                <sf:input path="age" type="number" />
			            </div>
			            <div>
			                <label>生日:</label>
			                <sf:input path="birth" type="date" />
			            </div>
			            <div>
			                <label>學歷:</label>
			                <sf:select path="education">
			                    <sf:option value="">請選擇</sf:option>
			                    <sf:options items="${dataMap.educationData}" 
			                                itemValue="id" 
			                                itemLabel="name" />
			                </sf:select>
			            </div>
			            <div>
			                <label>性別:</label>
			                <sf:radiobuttons path="sex" 
			                                 items="${dataMap.sexData}" 
			                                 cssClass="element-margin" />
			            </div>
			            <div>
			                <label>興趣:</label>
			                <sf:checkboxes path="interest" 
			                               items="${dataMap.interestData}" 
			                               cssClass="element-margin" />
			            </div>
			            <div>
			                <label>履歷:</label>
			                <sf:textarea path="resume" />
			            </div>
						<!-- 自訂表單元素 --> 
						<input type="hidden" name="_method" id="_method" th:value="${ _method }"> <!-- model.addAttribute("_method", "POST"); -->
						<button type="submit" class="pure-button pure-button-primary"
						        th:text="${submitButtonName}">submit</button><!-- model.addAttribute("submitButtonName", "新增"); --> 
					</fieldset>
				</sf:form>
			</td>
			<td valign="top" style="padding: 6px"> <!-- 垂直對齊 -->
				<!-- User List -->
				<form class="pure-form">
					<fieldset>
						<legend>User List</legend>
							<table class="pure-table pure-table-bordered">
								<thead>
									<tr>
				                        <th class="no-wrap">序號</th>
				                        <th class="no-wrap">姓名</th>
				                        <th class="no-wrap">年齡</th>
				                        <th class="no-wrap">生日</th>
				                        <th class="no-wrap">學歷</th>
				                        <th class="no-wrap">性別</th>
				                        <th class="no-wrap">興趣</th>
				                        <th class="no-wrap">履歷</th>
				                        <th class="no-wrap">編輯</th>
				                        <th class="no-wrap">刪除</th>
                    				</tr>
								</thead>
								<tbody>
									<tr th:each="user, status : ${users}">
										<td class="no-wrap" th:text="${status.index}"></td>
                        				<td class="no-wrap" th:text="${user.name}"></td>
                        				<td class="no-wrap" th:text="${user.age}"></td>
                        				<td class="no-wrap" th:text="${#dates.format(user.birth, 'yyyy-MM-dd')}"></td>
                        				
                        				<td class="no-wrap">
	                            			<!-- 學歷名稱顯示 -->
	                            			<span th:each="edu : ${dataMap.educationData}"
	                                  			  th:if="${user.education == edu.id}"
	                                              th:text="${edu.name}">
	                            			</span>
                        				</td>
                        				
                        				<td class="no-wrap" th:text="${user.sex}"></td>
                        				
				                        <td class="no-wrap">
				                            <!-- 興趣陣列用空格連接 -->
				                            <span th:text="${#strings.arrayJoin(user.interest, ' ')}"></span>
				                        </td>
				                        
                        				<td class="no-wrap" th:text="${user.resume}"></td>
                        				
										<td class="no-wrap">
				                            <!-- 編輯按鈕 -->
				                            <button type="button"
				                                    class="pure-button"
				                                    th:onclick="'window.location.href=\'' + @{user/{id}(id=${status.index})} + '\''">
				                                編輯
				                            </button>
                        				</td>
										<td>
											<a th:href="@{/user/{id}(id=${status.index}, action='delete')}" 
           					   			       class="pure-button pure-button-primary">刪除</a>
										</td>
									</tr>
								</tbody>
							</table>
					</fieldset>
				</form>
			</td>
		</tr>
	</table>
</body>
</html>